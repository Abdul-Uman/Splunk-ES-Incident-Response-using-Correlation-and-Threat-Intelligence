# Splunk ES Incident Response using Correlation and Threat Intelligence

## Table of Contents

- [Introduction](#introduction)
- [Creating a Correlation Search in Splunk ES](#creating-a-correlation-search-in-splunk-es)
  - [Large Number of Windows Login Failure Attempts](#large-number-of-windows-login-failure-attempts)
- [Incident Response Workflow](#incident-response-workflow)
  - [Identifying and Responding to Alerts](#identifying-and-responding-to-alerts)
  - [Communication and Ticketing](#communication-and-ticketing)
  - [Determining True or False Positive](#determining-true-or-false-positive)
  - [Remediation Steps](#remediation-steps)
- [Contributing](#contributing)
- [License](#license)

## Introduction

This repository documents the process of using **Splunk Enterprise Security (ES)** to create and manage security incidents, with a focus on large numbers of Windows login failure attempts from the same user. The guide includes steps for creating correlation searches, responding to alerts, and managing incidents using ServiceNow and email communications.

## Creating a Correlation Search in Splunk ES

### Large Number of Windows Login Failure Attempts

**Description**: This section covers the steps to create a correlation search in Splunk ES for detecting a large number of Windows login failure attempts from the same user.

1. **Access Splunk ES**: Open your Splunk ES environment.
2. **Navigate to Content Management**: Go to the **Configure** menu, then select **Content Management**.
3. **Create New Correlation Search**:
   - Select **New Content** and choose **Correlation Search**.
   - Configure the search to detect multiple login failures from the same user.
   - Write the SPL query to define the conditions for the alert.
   - Set up a notable event to be triggered when the conditions are met.
4. **Save and Deploy**: Save the correlation search and ensure itâ€™s deployed.

[Link to Full Guide on Creating Correlation Search](#)

## Incident Response Workflow

### Identifying and Responding to Alerts

**Description**: This section outlines the process for identifying alerts generated by the correlation search and responding to them in Splunk ES.

1. **Monitor Incident Review**: Alerts based on the correlation search will appear in the **Incident Review** dashboard.
2. **Export Historical Events**: For each alert, collect historical event data and download it as a CSV file for further analysis.

[Link to Full Guide on Responding to Alerts](#)

### Communication and Ticketing

**Description**: This section covers the steps to communicate with relevant teams and manage incidents using ServiceNow.

1. **Create a Ticket in ServiceNow**: Document the incident by creating a ticket in the ServiceNow platform.
2. **Email Communication**: Send an email to the respective team, asking them to verify whether the event is a true positive or false positive.

[Link to Full Guide on Communication and Ticketing](#)

### Determining True or False Positive

**Description**: This section provides guidance on analyzing the team's response to determine whether the event is a true or false positive.

1. **False Positive Scenario**:
   - If the team confirms the event was caused by a benign script or cookie (e.g., a background process with outdated credentials), classify the incident as a false positive.
   - Close the incident after documenting the findings.

2. **True Positive Scenario**:
   - If the team confirms that the user did not perform the actions, suspect a potential compromise.
   - Initiate further investigation and containment procedures.

[Link to Full Guide on Analyzing Responses](#)

### Remediation Steps

**Description**: This section outlines the actions to take in the event of a confirmed true positive, focusing on minimizing the cost of impact and remediation.

1. **Isolate the System**: Disconnect the compromised device from the network to prevent further unauthorized access.
2. **Log Review**: Analyze logs from firewalls, proxy servers, and email gateways to identify the attack vector and scope.
3. **Remediate the System**: If no clear evidence of malicious activity is found, consider reimaging the system to restore it to a secure state.
4. **Minimize Impact**: Ensure that the cost of impact and remediation is kept to a minimum while fully addressing the threat.

[Link to Full Guide on Remediation Steps](#)

## Contributing

Contributions to this repository are welcome. Whether it's improving documentation, adding new incident response examples, or sharing insights on effective threat management, your input is valuable.

[Link to Contribution Guidelines](#)

## License

This project is licensed under the MIT License. For more details, see the [LICENSE](LICENSE) file.

